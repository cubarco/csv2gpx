(function(t){function e(e){for(var r,i,l=e[0],s=e[1],c=e[2],p=0,d=[];p<l.length;p++)i=l[p],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);u&&u(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],r=!0,l=1;l<o.length;l++){var s=o[l];0!==n[s]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=o[0]))}return t}var r={},n={app:0},a=[];function i(e){if(r[e])return r[e].exports;var o=r[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=r,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(o,r,function(e){return t[e]}.bind(null,r));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="https://cdn.jsdelivr.net/gh/cubarco/csv2gpx@gh-pages/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=s;a.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"034f":function(t,e,o){"use strict";o("85ec")},"56d7":function(t,e,o){"use strict";o.r(e);o("e260"),o("e6cf"),o("cca6"),o("a79d");var r=o("2b0e"),n=o("5c96"),a=o.n(n),i=(o("0fae"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticStyle:{display:"flex","justify-content":"center"},attrs:{id:"app"}},[o("el-container",{staticStyle:{maxWidth:"700px"}},[o("el-main",[o("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"将足迹 APP 导出的 CSV 文件转换为 GPX 文件",type:"info",closable:!1}}),o("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"使用说明",type:"success",description:"足迹输出的 CSV 的 timestamp 为 UTC 时区，坐标为 WGS-84 参考系。若将输出的 GPX 文件用于设置照片的 GPS 信息（即 Geoset），可以使用默认勾选的 WGS84 to WGS84 模式。此模式下输出的坐标可以在群晖 7.0+ 的 Photos 中正确显示地理位置。",closable:!1}}),o("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"纯前端应用，不会上传 CSV 文件到服务器！",type:"warning"}}),o("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"群晖升级 7.0 后，Photos 的坐标系由 GCJ02 变更为 WGS84！",type:"warning"}}),o("el-upload",{attrs:{action:"",drag:"","on-preview":t.handlePreview,"on-remove":t.handleRemove,"before-remove":t.beforeRemove,"http-request":t.httpRequest,"auto-upload":!0,multiple:"","file-list":t.fileList,accept:".csv"}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[t._v(" 将CSV文件拖到此处，或"),o("em",[t._v("点击打开")])]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("源坐标参考系:")]),o("el-radio-group",{staticClass:"el-upload__tip",attrs:{slot:"tip",size:"mini"},on:{change:t.handleCrsFromChange},slot:"tip",model:{value:t.crsFrom,callback:function(e){t.crsFrom=e},expression:"crsFrom"}},[o("el-radio",{attrs:{label:"WGS84",border:""}},[t._v("WGS84（足迹）")]),o("el-radio",{attrs:{label:"GCJ02",border:""}}),o("el-radio",{attrs:{label:"BD09",border:""}})],1),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("目标坐标参考系:")]),o("el-radio-group",{staticClass:"el-upload__tip",attrs:{slot:"tip",size:"mini"},on:{change:t.handleCrsToChange},slot:"tip",model:{value:t.crsTo,callback:function(e){t.crsTo=e},expression:"crsTo"}},[o("el-radio",{attrs:{label:"WGS84",border:""}},[t._v("WGS84（Synology Photos）")]),o("el-radio",{attrs:{label:"GCJ02",border:""}},[t._v("GCJ02（DS Photo、高德、Google中国）")]),o("el-radio",{attrs:{label:"BD09",border:""}},[t._v("BD09（百度）")])],1),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("输出文件名:")]),o("el-input",{staticClass:"el-upload__tip",attrs:{slot:"tip",size:"mini",placeholder:"默认为: 时间.gpx"},on:{input:t.handleOutputFilenameChange},slot:"tip",model:{value:t.outputFilename,callback:function(e){t.outputFilename=e},expression:"outputFilename"}})],1)],1)],1)],1)}),l=[],s=(o("4ec9"),o("d3b7"),o("3ca3"),o("ddb0"),o("ac1f"),o("466d"),o("159b"),o("25f0"),o("b0c0"),o("1276"),o("369b")),c=o("0f2d"),u=o("21a6"),p=o("a6d4"),d=o("b9b9"),f=o.n(d);function m(t,e){if(window.crsTo==window.crsFrom)return[t,e];var o=new Map;o.set("WGS84",p["a"].WGS84),o.set("GCJ02",p["a"].GCJ02),o.set("BD09",p["a"].BD09);var r=o.get(window.crsFrom),n=o.get(window.crsTo),a=p["a"].transform([t,e],r,n);return a}function h(t,e,o){var r={$:{},lon:t,lat:e,time:o};return r}function v(){var t=window.outputFilename;return t&&0!=t.length?t.match(/.*\.gpx$/i)?t:t+".gpx":f()(new Date,"yyyy-mm-dd--HH-MM-ss")+".gpx"}function b(t,e){var o=s["parse"](t);o=o.data,o.shift();var r=[];""==o[o.length-1]&&o.pop(),o.forEach((function(t){var e=m(parseFloat(t[2]),parseFloat(t[3])),o=h(e[0],e[1],1e3*parseInt(t[0]));r.push(o)}));var n=new c["a"]({trk:[{trkseg:[{trkpt:r}]}]}),a=new Blob([n.toString()],{type:"application/gpx+xml;charset=utf-8"});Object(u["saveAs"])(a,v()),e.onSuccess&&e.onSuccess()}function g(t,e){if(t.name.match(/.*\.csv$/i)){var o=new FileReader;o.readAsDataURL(t),o.onload=function(t){b(atob(t.target.result.split(";base64,")[1]),e)}}else e.onError&&e.onError("只能打开 CSV 文件!")}window.outputFilename="",window.crsFrom="WGS84",window.crsTo="WGS84";var w={name:"App",data:function(){return{fileList:[],outputFilename:window.outputFilename,crsFrom:window.crsFrom,crsTo:window.crsTo}},methods:{handleCrsFromChange:function(t){window.crsFrom=t},handleCrsToChange:function(t){window.crsTo=t},handleOutputFilenameChange:function(t){window.outputFilename=this.outputFilename},httpRequest:function(t){var e=this;g(t.file,{onError:function(o){o&&0!=o.length&&e.$message.error(o),t.onError()},onSuccess:function(){t.onSuccess()}})},handleRemove:function(t,e){},handlePreview:function(t){var e=this;g(t.raw,{onError:function(t){t&&0!=t.length&&e.$message.error(t)},onSuccess:function(){}})},beforeRemove:function(t,e){return!0}}},S=w,y=(o("034f"),o("2877")),_=Object(y["a"])(S,i,l,!1,null,null,null),C=_.exports;r["default"].use(a.a),r["default"].config.prouctionTip=!1,new r["default"]({render:function(t){return t(C)}}).$mount("#app")},"85ec":function(t,e,o){}});
//# sourceMappingURL=app.fe40c6d9.js.map