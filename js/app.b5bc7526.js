(function(e){function t(t){for(var o,i,l=t[0],s=t[1],c=t[2],u=0,d=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);p&&p(t);while(d.length)d.shift()();return n.push.apply(n,c||[]),r()}function r(){for(var e,t=0;t<n.length;t++){for(var r=n[t],o=!0,l=1;l<r.length;l++){var s=r[l];0!==a[s]&&(o=!1)}o&&(n.splice(t--,1),e=i(i.s=r[0]))}return e}var o={},a={app:0},n=[];function i(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=o,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(r,o,function(t){return e[t]}.bind(null,o));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/csv2gpx/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var p=s;n.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);var o=r("2b0e"),a=r("5c96"),n=r.n(a),i=(r("0fae"),function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"flex","justify-content":"center"},attrs:{id:"app"}},[t("el-container",{staticStyle:{maxWidth:"700px"}},[t("el-main",[t("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"将足迹 APP 导出的 CSV 文件转换为 GPX 文件",type:"info",closable:!1}}),t("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"使用说明",type:"success",description:"足迹输出的 CSV 的 timestamp 为 UTC 时区，坐标为 WGS-84 参考系。若将输出的 GPX 文件用于设置照片的 GPS 信息（即 Geoset），可以使用默认勾选的 WGS84 to WGS84 模式。此模式下输出的坐标可以在群晖 7.0+ 的 Photos 中正确显示地理位置。",closable:!1}}),t("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"纯前端应用，不会上传 CSV 文件到服务器！",type:"warning"}}),t("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"群晖升级 7.0 后，Photos 的坐标系由 GCJ02 变更为 WGS84！",type:"warning"}}),t("el-upload",{attrs:{action:"",drag:"","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,"http-request":e.httpRequest,"auto-upload":!0,multiple:"","file-list":e.fileList,accept:".csv"}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将CSV文件拖到此处，或"),t("em",[e._v("点击打开")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("源坐标参考系:")]),t("el-radio-group",{staticClass:"el-upload__tip",attrs:{slot:"tip",size:"mini"},on:{change:e.handleCrsFromChange},slot:"tip",model:{value:e.crsFrom,callback:function(t){e.crsFrom=t},expression:"crsFrom"}},[t("el-radio",{attrs:{label:"WGS84",border:""}},[e._v("WGS84（足迹）")]),t("el-radio",{attrs:{label:"GCJ02",border:""}}),t("el-radio",{attrs:{label:"BD09",border:""}})],1),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("目标坐标参考系:")]),t("el-radio-group",{staticClass:"el-upload__tip",attrs:{slot:"tip",size:"mini"},on:{change:e.handleCrsToChange},slot:"tip",model:{value:e.crsTo,callback:function(t){e.crsTo=t},expression:"crsTo"}},[t("el-radio",{attrs:{label:"WGS84",border:""}},[e._v("WGS84（Synology Photos）")]),t("el-radio",{attrs:{label:"GCJ02",border:""}},[e._v("GCJ02（DS Photo、高德、Google中国）")]),t("el-radio",{attrs:{label:"BD09",border:""}},[e._v("BD09（百度）")])],1),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.oneYearLimitChecked,expression:"oneYearLimitChecked"}],attrs:{type:"checkbox",checked:"",id:"checkbox"},domProps:{checked:Array.isArray(e.oneYearLimitChecked)?e._i(e.oneYearLimitChecked,null)>-1:e.oneYearLimitChecked},on:{change:[function(t){var r=e.oneYearLimitChecked,o=t.target,a=!!o.checked;if(Array.isArray(r)){var n=null,i=e._i(r,n);o.checked?i<0&&(e.oneYearLimitChecked=r.concat([n])):i>-1&&(e.oneYearLimitChecked=r.slice(0,i).concat(r.slice(i+1)))}else e.oneYearLimitChecked=a},e.handleOneYearLimitChange]}}),t("label",{attrs:{for:"checkbox"}},[e._v("只导出一年内轨迹")])]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("输出文件名:")]),t("el-input",{staticClass:"el-upload__tip",attrs:{slot:"tip",size:"mini",placeholder:"默认为: 时间.gpx"},on:{input:e.handleOutputFilenameChange},slot:"tip",model:{value:e.outputFilename,callback:function(t){e.outputFilename=t},expression:"outputFilename"}})],1)],1)],1)],1)}),l=[],s=(r("b7ef"),r("369b")),c=r("0f2d"),p=r("21a6"),u=r("a6d4"),d=r("b9b9"),m=r.n(d);function h(e,t){if(window.crsTo==window.crsFrom)return[e,t];let r=new Map;r.set("WGS84",u["a"].WGS84),r.set("GCJ02",u["a"].GCJ02),r.set("BD09",u["a"].BD09);let o=r.get(window.crsFrom),a=r.get(window.crsTo),n=u["a"].transform([e,t],o,a);return n}function f(e,t,r){var o={$:{},lon:e,lat:t,time:r};return o}function v(){var e=window.outputFilename;return e&&0!=e.length?e.match(/.*\.gpx$/i)?e:e+".gpx":m()(new Date,"yyyy-mm-dd--HH-MM-ss")+".gpx"}function w(e,t){var r=s["parse"](e);r=r.data,r.shift();let o=[];""==r[r.length-1]&&r.pop();var a=Math.floor(Date.now()/1e3);r.forEach(e=>{var t=parseInt(e[0]);if(!(window.oneYearLimitChecked&&t<a-31536e3)){var r=h(parseFloat(e[2]),parseFloat(e[3])),n=f(r[0],r[1],1e3*t);o.push(n)}});var n=new c["a"]({trk:[{trkseg:[{trkpt:o}]}]}),i=new Blob([n.toString()],{type:"application/gpx+xml;charset=utf-8"});Object(p["saveAs"])(i,v()),t.onSuccess&&t.onSuccess()}function b(e,t){if(!e.name.match(/.*\.csv$/i))return void(t.onError&&t.onError("只能打开 CSV 文件!"));let r=new FileReader;r.readAsDataURL(e),r.onload=e=>{w(atob(e.target.result.split(";base64,")[1]),t)}}window.outputFilename="",window.crsFrom="WGS84",window.crsTo="WGS84",window.oneYearLimitChecked=!0;var g={name:"App",data(){return{fileList:[],outputFilename:window.outputFilename,crsFrom:window.crsFrom,crsTo:window.crsTo,oneYearLimitChecked:window.oneYearLimitChecked}},methods:{handleOneYearLimitChange(){window.oneYearLimitChecked=this.oneYearLimitChecked},handleCrsFromChange(e){window.crsFrom=e},handleCrsToChange(e){window.crsTo=e},handleOutputFilenameChange(e){window.outputFilename=this.outputFilename},httpRequest(e){var t=this;b(e.file,{onError:r=>{r&&0!=r.length&&t.$message.error(r),e.onError()},onSuccess(){e.onSuccess()}})},handleRemove(e,t){},handlePreview(e){var t=this;b(e.raw,{onError:e=>{e&&0!=e.length&&t.$message.error(e)},onSuccess(){}})},beforeRemove(e,t){return!0}}},C=g,y=(r("e14c"),r("2877")),S=Object(y["a"])(C,i,l,!1,null,null,null),_=S.exports;o["default"].use(n.a),o["default"].config.prouctionTip=!1,new o["default"]({render:e=>e(_)}).$mount("#app")},"893e":function(e,t,r){},e14c:function(e,t,r){"use strict";r("893e")}});
//# sourceMappingURL=app.b5bc7526.js.map